<h1>Planning Application</h1>

<!-- Nav tabs -->
<ul class="nav nav-tabs" role="tablist">
  <li role="presentation" class="active"><a href="#basic" aria-controls="basic" role="tab" data-toggle="tab">Application Details</a></li>
  <li role="presentation"><a href="#states" aria-controls="states" role="tab" data-toggle="tab">Application States</a></li>
  <li role="presentation"><a href="#photos" aria-controls="photos" role="tab" data-toggle="tab">Drawings</a></li>
</ul>

  <!-- Tab panes -->
<div class="tab-content" *ngIf="planningApp">
  <!-- Planning tab -->
  <div role="tabpanel" class="tab-pane active" id="basic">
    <div class="well">
      <form #f1="ngForm" (submit)="submit()">
          <div class="form-group">
              <label for="planningStatus">Application Status</label>
              <input id="planningStatus" type="text" class="form-control" [(ngModel)]="planningApp.planningStatus" name="planningStatus"></div>
        
          <div class="form-group">
            <label for="completionDate">Application Estimated Completion Date</label>
            <input id="completionDate" type="text" class="form-control" [(ngModel)]="planningApp.completionDate" name="completionDate"></div>
      </form>

      <form #f="ngForm" (submit)="submit()">
        <div class="form-group">
          <label for="name">Description</label>
          <input id="name" type="text" class="form-control" [(ngModel)]="planningApp.name" name="name" required #applicationName="ngModel"></div>
          <div class="alert alert-danger" *ngIf="applicationName.touched && !applicationName.valid">Please enter a description.</div>

        <div class="form-group">
          <label for="currentStateStatus">Current Status</label>
          <input id="currentStateStatus" type="text" class="form-control" [(ngModel)]="planningApp.currentStateStatus" name="currentStateStatus"></div>

        <div class="form-group">
          <label for="currentState">Current State</label>
          <input id="currentState" type="text" class="form-control" [(ngModel)]="planningApp.currentState" name="currentState"></div>
      
        <div class="form-group">
          <label for="expectedStateCompletionDate">Expected Completion Date</label>
          <input id="expectedStateCompletionDate" type="text" class="form-control" [(ngModel)]="planningApp.expectedStateCompletionDate" name="expectedStateCompletionDate"></div>
      

        <div class="form-group">
          <label for="nextState">Next State</label>
          <input id="nextState" type="text" class="form-control" [(ngModel)]="planningApp.nextState" name="nextState">
        </div>

        <button class="btn btn-primary" [disabled]="!f.valid">Next State</button>
        <!-- <button *ngIf="vehicle.id" class="btn btn-danger" type="button" (click)="delete()">Delete</button> -->
      </form>
    </div>
  </div>
  <!-- Photos tab -->
  <div role="tabpanel" class="tab-pane" id="states">
    <head>
        <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        
        th, td {
            text-align: left;
            padding: 4px;
        } 
        tr:nth-child(even) {background-color: #e9e9e9;}
      </style>
    </head>
    
    <h3>Planning Application States</h3>
    <div class="well">
    <table class="table">
      <thead>
        <tr>
          <th>State Name</th>
          <th>Due By Date</th>
          <th>Date Completed</th>
          <th>State Status</th>
          <th>CurrentState</th>
        </tr>
      </thead>
      <!-- <tr *ngFor="let r of queryResult.items">
        <td>{{ r.id }}</td>
        <td>
          <a [routerLink]="['/vehicles/', v.id]">View</a>
        </td>
      </tr> -->
      <tr *ngFor="let v of planningApp.planningAppStates">
          <td>{{ v.stateName}}</td>
          <td>{{ v.dueByDate }}</td>
          <td>{{ v.dateCompleted }}</td>
          <td>{{ v.stateStatus }}</td>
          <td>{{ v.currentState }}</td>
          <td>
            <a [routerLink]="['/planningapps/', v.id]">View</a>
          </td>
        </tr>
      </tbody>
      <div></div>
    </table>
  </div>
  </div>
  <!-- Drawings tab -->
  <div role="tabpanel" class="tab-pane" id="photos">
      <h2>Photos</h2>
      <input type="file" (change)="uploadPhoto()" #fileInput> 
      <div class="progress" *ngIf="progress && progress.percentage < 100">
        <div class="progress-bar" [style.width]="progress.percentage + '%'"> 
          <span class="sr-only">{{ progress.percentage }}% Complete</span>
        </div>
      </div>
      <img *ngFor="let photo of photos" src="/uploads/{{ photo.fileName }}" class="img-thumbnail">
    </div>
</div>